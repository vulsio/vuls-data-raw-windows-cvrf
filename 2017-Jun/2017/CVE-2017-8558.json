{
	"document_title": "June 2017 Security Updates",
	"document_type": "Security Update",
	"documentpublisher": {
		"type": "Vendor",
		"contact_details": "secure@microsoft.com",
		"issuing_authority": "The Microsoft Security Response Center (MSRC) identifies, monitors, resolves, and responds to security incidents and Microsoft software security vulnerabilities. For more information, see http://www.microsoft.com/security/msrc."
	},
	"documenttracking": {
		"identification": {
			"id": "CVE-2017-8558",
			"alias": "CVE-2017-8558"
		},
		"status": "Final",
		"version": "1.0",
		"revisionhistory": {
			"revision": {
				"number": "21",
				"date": "2019-06-11T07:00:00Z",
				"description": "June 2017 Security Updates"
			}
		},
		"initial_release_date": "2017-06-13T07:00:00Z",
		"current_release_date": "2019-06-11T07:00:00Z"
	},
	"documentnotes": {
		"note": [
			{
				"text": "<p>The June security release consists of security updates for the following software:</p>\n<ul>\n<li>Internet Explorer</li>\n<li>Microsoft Edge</li>\n<li>Microsoft Windows</li>\n<li>Microsoft Office and Microsoft Office Services and Web Apps</li>\n<li>Silverlight</li>\n<li>Skype for Business and Lync</li>\n<li>Adobe Flash Player</li>\n<li>Microsoft Malware Protection Engine</li>\n</ul>\n<p>Please note the following information regarding the security updates:</p>\n<ul>\n<li>Beginning with the October 2016 release, Microsoft is changing the update servicing model for Windows 7, Windows Server 2008 R2, Windows 8.1, Windows Server 2012, and Windows Server 2012 R2. For more information, please see this Microsoft Technet article, <a href=\"https://blogs.technet.microsoft.com/windowsitpro/2016/08/15/further-simplifying-servicing-model-for-windows-7-and-windows-8-1/\">Further simplifying servicing models forWindows 7 and Windows 8.1</a>.</li>\n<li>Windows 10 updates are cumulative. The monthly security release includes all security fixes for vulnerabilities that affect Windows 10, in addition to non-security updates. The updates are available via the <a href=\"http://catalog.update.microsoft.com/v7/site/Home.aspx\">Microsoft Update Catalog</a>.</li>\n<li>Starting in March 2017, a delta package will be available on the Microsoft Update Catalog for Windows 10 version 1607 and newer.  This delta package contains just the delta changes between the previous month and the current release.</li>\n<li>Updates for Windows RT 8.1 and Microsoft Office RT software are only available via <a href=\"http://go.microsoft.com/fwlink/?LinkId=21130\">Windows Update</a>.</li>\n<li>In addition to security changes for the vulnerabilities, updates include defense-in-depth updates to help improve security-related features.</li>\n</ul>\n<p>**Known Issues **</p>\n<ul>\n<li><a href=\"https://support.microsoft.com/help/4022717\">4022717</a></li>\n<li><a href=\"https://support.microsoft.com/help/4022726\">4022726</a></li>\n<li><a href=\"https://support.microsoft.com/help/4022715\">4022715</a></li>\n<li><a href=\"https://support.microsoft.com/help/4021558\">4021558</a></li>\n<li><a href=\"https://support.microsoft.com/help/3118388\">3118388</a></li>\n<li><a href=\"https://support.microsoft.com/help/3172519\">3172519</a></li>\n<li><a href=\"https://support.microsoft.com/help/3178664\">3178664</a></li>\n<li><a href=\"https://support.microsoft.com/help/3191932\">3191932</a></li>\n<li><a href=\"https://support.microsoft.com/help/3191938\">3191938</a></li>\n<li><a href=\"https://support.microsoft.com/help/3191898\">3191898</a></li>\n<li><a href=\"https://support.microsoft.com/help/3203467\">3203467</a></li>\n<li><a href=\"https://support.microsoft.com/help/4022714\">4022714</a></li>\n<li><a href=\"https://support.microsoft.com/help/4022719\">4022719</a></li>\n<li><a href=\"https://support.microsoft.com/help/4022724\">4022724</a></li>\n<li><a href=\"https://support.microsoft.com/help/4022725\">4022725</a></li>\n<li><a href=\"https://support.microsoft.com/help/4022727\">4022727</a></li>\n</ul>\n",
				"title": "Release Notes",
				"audience": "Public",
				"type": "Details",
				"ordinal": "0"
			},
			{
				"text": "The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.",
				"title": "Legal Disclaimer",
				"audience": "Public",
				"type": "Legal Disclaimer",
				"ordinal": "1"
			}
		]
	},
	"producttree": {
		"branch": {
			"type": "Vendor",
			"name": "Microsoft",
			"branch": [
				{
					"type": "Product Family",
					"name": "System Center",
					"fullproductname": [
						{
							"text": "Microsoft Endpoint Protection",
							"productid": "11430"
						},
						{
							"text": "Microsoft Forefront Endpoint Protection 2010",
							"productid": "11431"
						},
						{
							"text": "Microsoft Forefront Endpoint Protection",
							"productid": "10330"
						},
						{
							"text": "Microsoft Security Essentials",
							"productid": "10013"
						},
						{
							"text": "Windows Intune Endpoint Protection",
							"productid": "10334"
						},
						{
							"text": "Windows Defender on Windows 10 Version 1703 for 32-bit Systems",
							"productid": "251-10951"
						},
						{
							"text": "Windows Defender on Windows 10 for 32-bit Systems",
							"productid": "251-10729"
						},
						{
							"text": "Windows Defender on Windows 10 Version 1511 for 32-bit Systems",
							"productid": "251-10789"
						},
						{
							"text": "Windows Defender on Windows 10 Version 1607 for 32-bit Systems",
							"productid": "251-10852"
						},
						{
							"text": "Windows Defender on Windows 7 for 32-bit Systems Service Pack 1",
							"productid": "251-10047"
						},
						{
							"text": "Windows Defender on Windows 8.1 for 32-bit systems",
							"productid": "251-10481"
						},
						{
							"text": "Windows Defender on Windows Server 2008 for 32-bit Systems Service Pack 2",
							"productid": "251-9312"
						},
						{
							"text": "Windows Defender on Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)",
							"productid": "251-10287"
						}
					]
				}
			]
		}
	},
	"vulnerability": [
		{
			"ordinal": "97",
			"title": "Microsoft Malware Protection Engine Remote Code Execution Vulnerability",
			"notes": {
				"note": [
					{
						"text": "<p>A remote code execution vulnerability exists when the Microsoft Malware Protection Engine does not properly scan a specially crafted file, leading to memory corruption. An attacker who successfully exploited this vulnerability could execute arbitrary code in the security context of the LocalSystem account and take control of the system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.</p>\n<p>To exploit this vulnerability, a specially crafted file must be scanned by an affected version of the Microsoft Malware Protection Engine. There are many ways that an attacker could place a specially crafted file in a location that is scanned by the Microsoft Malware Protection Engine. For example, an attacker could use a website to deliver a specially crafted file to the victim's system that is scanned when the website is viewed by the user. An attacker could also deliver a specially crafted file via an email message or in an Instant Messenger message that is scanned when the file is opened. In addition, an attacker could take advantage of websites that accept or host user-provided content, to upload a specially crafted file to a shared location that is scanned by the Malware Protection Engine running on the hosting server.</p>\n<p>If the affected antimalware software has real-time protection turned on, the Microsoft Malware Protection Engine will scan files automatically, leading to exploitation of the vulnerability when the specially crafted file is scanned. If real-time scanning is not enabled, the attacker would need to wait until a scheduled scan occurs in order for the vulnerability to be exploited. All systems running an affected version of antimalware software are primarily at risk.</p>\n<p>The update addresses the vulnerability by correcting the manner in which the Microsoft Malware Protection Engine scans specially crafted files.</p>\n<p>Note: Typically, no action is required of enterprise administrators or end users to install updates for the Microsoft Malware Protection Engine, because the built-in mechanism for the automatic detection and deployment of updates will apply the update within 48 hours of release. The exact time frame depends on the software used, Internet connection, and infrastructure configuration.</p>\n",
						"title": "Description",
						"type": "Description",
						"ordinal": "0"
					},
					{
						"text": "<table>\n<thead>\n<tr>\n<th>References</th>\n<th>Identification</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Last version of the Microsoft Malware Protection Engine affected by this vulnerability</td>\n<td>Version 1.1.13804.0</td>\n</tr>\n<tr>\n<td>First version of the Microsoft Malware Protection Engine with this vulnerability addressed</td>\n<td>Version 1.1.13903.0</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Why is no action required to install this update?</strong>\nIn response to a constantly changing threat landscape, Microsoft frequently updates malware definitions and the Microsoft Malware Protection Engine. In order to be effective in helping protect against new and prevalent threats, antimalware software must be kept up to date with these updates in a timely manner.</p>\n<p>For enterprise deployments as well as end users, the default configuration in Microsoft antimalware software helps ensure that malware definitions and the Microsoft Malware Protection Engine are kept up to date automatically. Product documentation also recommends that products are configured for automatic updating.</p>\n<p>Best practices recommend that customers regularly verify whether software distribution, such as the automatic deployment of Microsoft Malware Protection Engine updates and malware definitions, is working as expected in their environment.</p>\n<p><strong>How often are the Microsoft Malware Protection Engine and malware definitions updated?</strong>\nMicrosoft typically releases an update for the Microsoft Malware Protection Engine once a month or as needed to protect against new threats. Microsoft also typically updates the malware definitions three times daily and can increase the frequency when needed.</p>\n<p>Depending on which Microsoft antimalware software is used and how it is configured, the software may search for engine and definition updates every day when connected to the Internet, up to multiple times daily. Customers can also choose to manually check for updates at any time.</p>\n<p><strong>What is the Microsoft Malware Protection Engine?</strong>\nThe Microsoft Malware Protection Engine, mpengine.dll, provides the scanning, detection, and cleaning capabilities for Microsoft antivirus and antispyware software.</p>\n<p><strong>Does this update contain any additional security-related changes to functionality?</strong>\nYes.  In addition to the changes that are listed for this vulnerability, this update includes defense-in-depth updates to help improve security-related features.</p>\n<p><strong>Where can I find more information about Microsoft antimalware technology?</strong>\nFor more information, visit the <a href=\"https://www.microsoft.com/security/portal/\">Microsoft Malware Protection Center</a> website.</p>\n<p><strong>Suggested Actions</strong></p>\n<p><strong>Verify that the update is installed</strong>\nCustomers should verify that the latest version of the Microsoft Malware Protection Engine and definition updates are being actively downloaded and installed for their Microsoft antimalware products.</p>\n<p>For more information on how to verify the version number for the Microsoft Malware Protection Engine that your software is currently using, see the section, &quot;Verifying Update Installation&quot;, in <a href=\"https://support.microsoft.com/kb/2510781\">Microsoft Knowledge Base Article 2510781</a>.</p>\n<p>For affected software, verify that the Microsoft Malware Protection Engine version is 1.1.13903.0 or later.</p>\n<p><strong>If necessary, install the update</strong>\nAdministrators of enterprise antimalware deployments should ensure that their update management software is configured to automatically approve and distribute engine updates and new malware definitions. Enterprise administrators should also verify that the latest version of the Microsoft Malware Protection Engine and definition updates are being actively downloaded, approved and deployed in their environment.</p>\n<p>For end-users, the affected software provides built-in mechanisms for the automatic detection and deployment of this update. For these customers, the update will be applied within 48 hours of its availability. The exact time frame depends on the software used, Internet connection, and infrastructure configuration. End users that do not wish to wait can manually update their antimalware software.</p>\n<p>For more information on how to manually update the Microsoft Malware Protection Engine and malware definitions, refer to<a href=\"https://support.microsoft.com/kb/2510781\"> Microsoft Knowledge Base Article 2510781</a>.</p>\n",
						"title": "FAQ",
						"type": "FAQ",
						"ordinal": "10"
					},
					{
						"text": "Microsoft Malware Protection Engine",
						"title": "Microsoft Malware Protection Engine",
						"type": "Tag",
						"ordinal": "20"
					}
				]
			},
			"cve": "CVE-2017-8558",
			"productstatuses": {
				"status": {
					"type": "Known Affected",
					"product_id": [
						"11430",
						"11431",
						"10330",
						"10013",
						"10334",
						"251-10951",
						"251-10729",
						"251-10789",
						"251-10852",
						"251-10047",
						"251-10481",
						"251-9312",
						"251-10287"
					]
				}
			},
			"threats": {
				"threat": [
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "11430"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "11431"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "10330"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "10013"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "10334"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "251-10951"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "251-10729"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "251-10789"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "251-10852"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "251-10047"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "251-10481"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "251-9312"
					},
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "251-10287"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "11430"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "11431"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "10330"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "10013"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "10334"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "251-10951"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "251-10729"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "251-10789"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "251-10852"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "251-10047"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "251-10481"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "251-9312"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "251-10287"
					},
					{
						"type": "Exploit Status",
						"description": "Publicly Disclosed:No;Exploited:No"
					}
				]
			},
			"cvssscoresets": {},
			"remediations": {
				"remediation": [
					{
						"type": "Mitigation",
						"description": "<p>The following <a href=\"https://technet.microsoft.com/library/security/dn848375.aspx#Mitigation\">mitigating factors</a> may be helpful in your situation:\nOnly x86 or 32-bit based versions of the Malware Protection Engine are affected.</p>\n",
						"affectedfiles": {}
					}
				]
			},
			"acknowledgments": {
				"acknowledgment": [
					{
						"name": "Tavis Ormandy of <a href =\"http://www.google.com/\">Google Project Zero</a>"
					}
				]
			},
			"revisionhistory": {
				"revision": [
					{
						"number": "1.0",
						"date": "2017-06-23T07:00:00Z",
						"description": "<p>Information published.</p>\n"
					}
				]
			}
		}
	]
}
