{
	"document_title": "December 2019 Security Updates",
	"document_type": "Security Update",
	"documentpublisher": {
		"type": "Vendor",
		"contact_details": "secure@microsoft.com",
		"issuing_authority": "The Microsoft Security Response Center (MSRC) identifies, monitors, resolves, and responds to security incidents and Microsoft software security vulnerabilities. For more information, see http://www.microsoft.com/security/msrc."
	},
	"documenttracking": {
		"identification": {
			"id": "ADV190026",
			"alias": "ADV190026"
		},
		"status": "Final",
		"version": "1.0",
		"revisionhistory": {
			"revision": {
				"number": "10",
				"date": "2020-07-23T07:00:00Z",
				"description": "December 2019 Security Updates"
			}
		},
		"initial_release_date": "2019-12-10T08:00:00Z",
		"current_release_date": "2020-07-23T07:00:00Z"
	},
	"documentnotes": {
		"note": [
			{
				"text": "<p>The December security release consists of security updates for the following software:</p>\n<ul>\n<li>Microsoft Windows</li>\n<li>Internet Explorer</li>\n<li>Microsoft Office and Microsoft Office Services and Web Apps</li>\n<li>SQL Server</li>\n<li>Visual Studio</li>\n<li>Skype for Business</li>\n</ul>\n<p>Please note the following information regarding the security updates:</p>\n<ul>\n<li>For information regarding enabling Windows 10, version 1909 features, please see <a href=\"https://techcommunity.microsoft.com/t5/Windows-IT-Pro-Blog/Windows-10-version-1909-delivery-options/ba-p/1002660\">Windows 10, version 1909 delivery options</a>. Note that Windows 10, versions 1903 and 1909 share a common core operating system with an identical set of system files. They will also share the same security update KBs.</li>\n<li>Windows 10 updates are cumulative. The monthly security release includes all security fixes for vulnerabilities that affect Windows 10, in addition to non-security updates. The updates are available via the <a href=\"http://catalog.update.microsoft.com/v7/site/Home.aspx\">Microsoft Update Catalog</a>.</li>\n<li>For information on lifecycle and support dates for Windows 10 operating systems, please see <a href=\"https://support.microsoft.com/en-us/help/13853/windows-lifecycle-fact-sheet\">Windows Lifecycle Facts Sheet</a>.</li>\n<li>A list of the latest servicing stack updates for each operating system can be found in <a href=\"https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/ADV990001\">ADV990001</a>. This list will be updated whenever a new servicing stack update is released. It is important to install the latest servicing stack update.</li>\n<li>Starting in May 2019, Internet Explorer 11 is available on Windows Server 2012. This configuration is present only in the IE Cumulative package.</li>\n<li>Updates for Windows RT 8.1 and Microsoft Office RT software are only available via <a href=\"http://go.microsoft.com/fwlink/?LinkId=21130\">Windows Update</a>.</li>\n<li>In addition to security changes for the vulnerabilities, updates include defense-in-depth updates to help improve security-related features.</li>\n</ul>\n<p><strong>The following CVEs have FAQs with additional information and may include * further steps to take after installing the updates. Please note that this is not a complete list of CVEs for this release.</strong></p>\n<ul>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV990001\">ADV990001</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV190026\">ADV190026</a> *</li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1349\">CVE-2019-1349</a> *</li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1350\">CVE-2019-1350</a> *</li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1351\">CVE-2019-1351</a> *</li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1352\">CVE-2019-1352</a> *</li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1354\">CVE-2019-1354</a> *</li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1387\">CVE-2019-1387</a> *</li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1400\">CVE-2019-1400</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1461\">CVE-2019-1461</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1462\">CVE-2019-1462</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1463\">CVE-2019-1463</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1464\">CVE-2019-1464</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1465\">CVE-2019-1465</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1466\">CVE-2019-1466</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1467\">CVE-2019-1467</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1469\">CVE-2019-1469</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1470\">CVE-2019-1470</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1472\">CVE-2019-1472</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1474\">CVE-2019-1474</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1480\">CVE-2019-1480</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1481\">CVE-2019-1481</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1486\">CVE-2019-1486</a> *</li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1487\">CVE-2019-1487</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1489\">CVE-2019-1489</a></li>\n</ul>\n<p><strong>Known Issues</strong></p>\n<p>The following KBs contain information about known issues with the security updates. For more information about Windows Known Issues, please see <a href=\"https://docs.microsoft.com/en-us/windows/release-information/windows-message-center\">Windows message center</a> (links to currently-supported versions of Windows are in the left pane).</p>\n<p>For a complete list of security update KBs, please see <a href=\"https://support.microsoft.com/help/20191210\">20191210</a>.</p>\n<table>\n<thead>\n<tr>\n<th>KB Article</th>\n<th>Applies To</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4484190\">4484190</a></td>\n<td>Excel 2013</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4484179\">4484179</a></td>\n<td>Excel 2016</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4461590\">4461590</a></td>\n<td>PowerPoint 2013</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4484190\">4484190</a></td>\n<td>PowerPoint 2016</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4484190\">4484190</a></td>\n<td>Word 2013</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4484190\">4484190</a></td>\n<td>Word 2016</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530681\">4530681</a></td>\n<td>Windows 10</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530684\">4530684</a></td>\n<td>Windows 10, version 1803, Windows Server version 1803, Windows 10, version 1809, Windows Server version 1809</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530689\">4530689</a></td>\n<td>Windows 10, version 1607, Windows Server 2016</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530691\">4530691</a></td>\n<td>Windows Server 2012 (Monthly Rollup)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530698\">4530698</a></td>\n<td>Windows Server 2012 (Security-only update)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530702\">4530702</a></td>\n<td>Windows 8.1, Windows Server 2012 R2 (Monthly Rollup)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530714\">4530714</a></td>\n<td>Windows 10, version 1709</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530715\">4530715</a></td>\n<td>Windows 10, version 1809, Windows Server 2019</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530717\">4530717</a></td>\n<td>Windows 10, version 1803, Windows Server version 1803</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530730\">4530730</a></td>\n<td>Windows 8.1, Windows Server 2012 R2 (Security-only update)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/4530734\">4530734</a></td>\n<td>Windows 7 SP1, Windows Server 2008 R2 SP1 (Monthly Rollup)</td>\n</tr>\n</tbody>\n</table>\n",
				"title": "Release Notes",
				"audience": "Public",
				"type": "Details",
				"ordinal": "0"
			},
			{
				"text": "The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.",
				"title": "Legal Disclaimer",
				"audience": "Public",
				"type": "Legal Disclaimer",
				"ordinal": "1"
			}
		]
	},
	"producttree": {
		"branch": {
			"type": "Vendor",
			"name": "Microsoft",
			"branch": [
				{
					"type": "Product Family",
					"name": "Windows",
					"fullproductname": [
						{
							"text": "None Available",
							"productid": "9237"
						}
					]
				}
			]
		}
	},
	"vulnerability": [
		{
			"ordinal": "0",
			"title": "Microsoft Guidance for cleaning up orphaned keys generated on vulnerable TPMs and used for Windows Hello for Business",
			"notes": {
				"note": [
					{
						"text": "<p>Microsoft is aware of an issue in Windows Hello for Business (WHfB) with public keys that persist after a device is removed from Active Directory, if the AD exists. After a user sets up Windows Hello for Business (WHfB), the WHfB public key is written to the on-premises Active Directory. The WHfB keys are tied to a user and a device that has been added to Azure AD, and if the device is removed, the corresponding WHfB key is considered orphaned. However, these orphaned keys are not deleted even when the device it was created on is no longer present. Any authentication to Azure AD using such an orphaned WHfB key will be rejected. However, some of these orphaned keys could lead to the following security issue in Active Directory 2016 or 2019, in either hybrid or on-premises environments.</p>\n<p>An authenticated attacker could obtain orphaned keys created on TPMs that were affected by <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361\">CVE-2017-15361</a> (ROCA), discussed in <a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012\">Microsoft Security Advisory ADV170012</a> to compute their WHfB private key from the orphaned public keys. The attacker could then impersonate the user by using the stolen private key to authenticate as the user within the domain using Public Key Cryptography for Initial Authentication (PKINIT).</p>\n<p>This attack is possible even if firmware and software updates have been applied to TPMs that were affected by <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361\">CVE-2017-15361</a> because the corresponding public keys might still exist in Active Directory.</p>\n<p>This advisory provides guidance for cleaning up any orphaned public keys that were generated with an unpatched TPM (before firmware updates discussed in <a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012\">ADV170012</a> were applied). Follow this guidance to identify and remove orphaned WHfB keys.</p>\n<p>This particular issue with orphaned public keys can be present when WHfB is set up in the following configurations:</p>\n<ul>\n<li>WHfB is deployed on Active Directory 2016 or 2019, either in hybrid mode or on-premises only.</li>\n<li>Currently have or have had in the past, WHfB keys generated on TPMs that were affected by CVE-2017-15361.</li>\n</ul>\n<p><strong>Important</strong>: Azure Active Directory (Azure AD) and Active Directory Federation Services (AD FS) are not affected by this issue. However, we strongly recommend that you follow the <strong>Recommended Actions</strong> section of ADV170012, and apply any firmware updates supplied by your TPM OEM, to avoid any exposure to Azure AD and AD FS. See Step #4 of the <strong>Recommended Actions</strong> for a list of OEMs and links to information for their updates.</p>\n",
						"title": "Description",
						"type": "Description",
						"ordinal": "0"
					},
					{
						"text": "<p><strong>1. What systems are at risk?</strong></p>\n<p>Individual machines or servers are not affected by this WHfB issue. Affected environments are defined in the <strong>Mitigations</strong> section of this advisory.</p>\n<p><strong>2. Has this issue been publicly disclosed?</strong></p>\n<p>Yes, this issue has been disclosed.</p>\n<p><strong>3. Have there been any active attacks detected?</strong></p>\n<p>No. When this security advisory was issued, Microsoft had not received any information to indicate that this issue had been publicly used to attack customers.</p>\n<p><strong>4. How do I know if my TPMs are affected by CVE-2017-15361? How do I fix them?</strong></p>\n<p>Please refer to <a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012\">Microsoft Security Advisory ADV170012</a> for more details on CVE-2017-15361. You must follow the guidance in ADV170012 and update your TPMs before applying the mitigations for identifying and removing the orphaned public keys.</p>\n<p><strong>5. I have updated all of my TPMs that were affected by CVE-2017-15361 with firmware provided by the OEM. Are my systems still affected?</strong></p>\n<p>Yes. Orphaned WHFB keys previously generated from those TPMs could still be stored in Active Directory.</p>\n<p><strong>6. My TPMs are not affected by CVE-2017-15361, but I do not enforce a policy to use TPMs for WHfB. Am I still affected?</strong></p>\n<p>In the absence of a hardware-required policy, WHFB will prefer using the TPM for storing the private key. If you do not have any TPMs that are affected by CVE-2017-15361, then you are not impacted. However, we recommend removing any orphaned keys in your directory by following the steps discussed in the <strong>Mitigations</strong> section of this advisory.</p>\n<p><strong>7. I am running pre-2016 versions of Active Directory. Do I also need to remove these orphaned keys?</strong></p>\n<p>While you are not affected by this WHFB issue, we strongly recommend removing these orphaned keys as a security hygiene measure.</p>\n<p><strong>8. I regularly audit and clean up stale devices in my environment. How did I end up with orphaned keys?</strong></p>\n<p>When a user provisions a WHFB credential, the public key is stored in the msDS-KeyCredentialLink attribute of the user object in Azure AD and on-premises Active Directory. If the device that was used to create the key is removed from Azure AD and Active Directory, the WHFB public key created for the user on that device is not automatically removed from the user object and it becomes an orphaned key.</p>\n<p><strong>9. I have deployed WHFB certificate trust in my environment and use certificates for authentication. Am I affected? Do I need to remove orphaned keys?</strong></p>\n<p>Yes. You are still affected by this issue if you have deployed certificate trust and have 2016 or 2019 DCs in your environment. These DC versions still support key-based authentication even if you have deployed end user certificates for authentication.</p>\n",
						"title": "FAQ",
						"type": "FAQ",
						"ordinal": "10"
					},
					{
						"text": "Windows Hello",
						"title": "Windows Hello",
						"type": "Tag",
						"ordinal": "20"
					}
				]
			},
			"cve": "ADV190026",
			"productstatuses": {
				"status": {
					"type": "Known Affected",
					"product_id": [
						"9237"
					]
				}
			},
			"threats": {
				"threat": [
					{
						"type": "Impact",
						"product_id": "9237"
					},
					{
						"type": "Severity",
						"product_id": "9237"
					},
					{
						"type": "Exploit Status",
						"description": "Publicly Disclosed:No;Exploited:No"
					}
				]
			},
			"cvssscoresets": {},
			"remediations": {
				"remediation": [
					{
						"type": "Mitigation",
						"description": "<p>Follow these steps to mitigate the issue with orphaned WHfB keys in your environment:</p>\n<ol>\n<li>Ensure your TPMs affected by CVE-2017-15361 are patched. See <a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012\">Microsoft Security Advisory ADV170012</a> for details.</li>\n<li>Install the WHfBTools Windows PowerShell module. See <a href=\"https://www.powershellgallery.com/packages/WHfBTools\">WHfBTools</a>.</li>\n</ol>\n<p>Use the WHfBTools PowerShell scripts to identify and remove keys, which <strong>will</strong> differ depending on whether your environment is a hybrid environment or an on-premises only environment. See <a href=\"https://support.microsoft.com/help/4533501\">Using WHfBTools PowerShell module for cleaning up orphaned Windows Hello for Business Keys for instructions</a> for complete instructions.</p>\n<ol start=\"3\">\n<li>Query your environment for orphaned WHfB keys and for keys affected by CVE-2017-15361 (ROCA).</li>\n<li>You can then do one of the following, using the appropriate PowerShell script:</li>\n</ol>\n<ul>\n<li>Delete orphaned WHfB keys.</li>\n<li>Delete keys affected by CVE-2017-15361. <strong>Important</strong> Be aware that if you delete ROCA vulnerable WHfB keys that are not orphaned yet, it will cause disruption to your users. You should ensure that these keys are orphaned before removing them from the directory.</li>\n<li>Delete both orphaned keys and keys affected by CVE-2017-15361.</li>\n</ul>\n<p>The scripts you will use to identify and remove keys differ depending on whether your environment is a hybrid environment or an on-premises only environment. See <a href=\"https://support.microsoft.com/help/4533501\">Using WHfBTools PowerShell module for cleaning up orphaned Windows Hello for Business Keys for instructions</a>.</p>\n<p><strong>Hybrid environment:</strong></p>\n<p>A hybrid environment consists of Active Directory 2016 or 2019, with synchronization to Azure AD with or without AD FS.</p>\n<p><strong>Note</strong></p>\n<ul>\n<li>If you haven’t updated your TPM first, simply deleting these keys from the directory is not sufficient to mitigate the issue. Setting up WHfB again will re-create keys that are affected by CVE-2017-15361.</li>\n<li>Deleting keys in Azure AD will automatically remove them in Active Directory as part of the synchronization process between Active Directory and Azure AD. If you are in a hybrid environment deleting the keys from only Active Directory is not sufficient as they will be re-written from Azure AD as a part of the synchronization process.</li>\n</ul>\n<p><strong>On-premises only environment:</strong></p>\n<p>An on-premises only environment consists of Active Directory 2016 or 2019, both with AD FS.</p>\n<p><strong>Note</strong></p>\n<p>If you haven’t updated your TPM first, deleting these keys from the directory is not sufficient to mitigate the issue. Setting up WHfB again will re-create keys that are affected by CVE-2017-15361.</p>\n",
						"affectedfiles": {}
					}
				]
			},
			"acknowledgments": {
				"acknowledgment": [
					{
						"name": "<a href=\"https://www.dsinternals.com\">Michael Grafnetter @MGrafnetter</a>"
					}
				]
			},
			"revisionhistory": {
				"revision": [
					{
						"number": "1.0",
						"date": "2019-12-03T08:00:00Z",
						"description": "<p>Information published.</p>\n"
					}
				]
			}
		}
	]
}
