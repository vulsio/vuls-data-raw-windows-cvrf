{
	"document_title": "June 2021 Security Updates",
	"document_type": "Security Update",
	"documentpublisher": {
		"type": "Vendor",
		"contact_details": "secure@microsoft.com",
		"issuing_authority": "The Microsoft Security Response Center (MSRC) identifies, monitors, resolves, and responds to security incidents and Microsoft software security vulnerabilities. For more information, see http://www.microsoft.com/security/msrc."
	},
	"documenttracking": {
		"identification": {
			"id": "CVE-2021-31985",
			"alias": "CVE-2021-31985"
		},
		"status": "Final",
		"version": "1.0",
		"revisionhistory": {
			"revision": {
				"number": "38",
				"date": "2023-03-14T07:00:00",
				"description": "June 2021 Security Updates"
			}
		},
		"initial_release_date": "2021-06-08T07:00:00",
		"current_release_date": "2023-03-14T07:00:00"
	},
	"documentnotes": {
		"note": [
			{
				"text": "<h2>Updates this Month</h2>\n<p>This release consists of security updates for the following products, features and roles.</p>\n<ul>\n<li>.NET Core &amp; Visual Studio</li>\n<li>3D Viewer</li>\n<li>Microsoft DWM Core Library</li>\n<li>Microsoft Edge (Chromium-based)</li>\n<li>Microsoft Intune</li>\n<li>Microsoft Office</li>\n<li>Microsoft Office Excel</li>\n<li>Microsoft Office Outlook</li>\n<li>Microsoft Office SharePoint</li>\n<li>Microsoft Scripting Engine</li>\n<li>Microsoft Windows Codecs Library</li>\n<li>Paint 3D</li>\n<li>Role: Hyper-V</li>\n<li>Visual Studio Code - Kubernetes Tools</li>\n<li>Windows Bind Filter Driver</li>\n<li>Windows Common Log File System Driver</li>\n<li>Windows Cryptographic Services</li>\n<li>Windows DCOM Server</li>\n<li>Windows Defender</li>\n<li>Windows Drivers</li>\n<li>Windows Event Logging Service</li>\n<li>Windows Filter Manager</li>\n<li>Windows HTML Platform</li>\n<li>Windows Installer</li>\n<li>Windows Kerberos</li>\n<li>Windows Kernel</li>\n<li>Windows Kernel-Mode Drivers</li>\n<li>Windows Network File System</li>\n<li>Windows NTFS</li>\n<li>Windows NTLM</li>\n<li>Windows Print Spooler Components</li>\n<li>Windows Remote Desktop</li>\n<li>Windows TCP/IP</li>\n</ul>\n<p>Please note the following information regarding the security updates:</p>\n<h2>Security Update Guide Blog Posts</h2>\n<table>\n<thead>\n<tr>\n<th>Date</th>\n<th>Blog Post</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>February 9, 2021</td>\n<td><a href=\"https://msrc-blog.microsoft.com/2021/02/09/continuing-to-listen-good-news-about-the-security-update-guide-api/\">Continuing to Listen: Good News about the Security Update Guide API</a></td>\n</tr>\n<tr>\n<td>January 13, 2021</td>\n<td><a href=\"https://msrc-blog.microsoft.com/2021/01/13/security-update-guide-supports-cves-assigned-by-industry-partners/\">Security Update Guide Supports CVEs Assigned by Industry Partners</a></td>\n</tr>\n<tr>\n<td>December 8, 2020</td>\n<td><a href=\"https://msrc-blog.microsoft.com/2020/12/08/security-update-guide-lets-keep-the-conversation-going/\">Security Update Guide: Let’s keep the conversation going</a></td>\n</tr>\n<tr>\n<td>November 9, 2020</td>\n<td><a href=\"https://msrc-blog.microsoft.com/2020/11/09/vulnerability-descriptions-in-the-new-version-of-the-security-update-guide/\">Vulnerability Descriptions in the New Version of the Security Update Guide</a></td>\n</tr>\n</tbody>\n</table>\n<h2>Relevant Information</h2>\n<ul>\n<li>Windows 10 updates are cumulative. The monthly security release includes all security fixes for vulnerabilities that affect Windows 10, in addition to non-security updates. The updates are available via the <a href=\"https://www.catalog.update.microsoft.com/Home.aspx\">Microsoft Update Catalog</a>. For information on lifecycle and support dates for Windows 10 operating systems, please see <a href=\"https://docs.microsoft.com/en-us/lifecycle/faq/windows\">Windows Lifecycle Facts Sheet</a>.</li>\n<li>Microsoft is improving Windows Release Notes. For more information, please see <a href=\"https://techcommunity.microsoft.com/t5/windows-it-pro-blog/what-s-next-for-windows-release-notes/ba-p/1754399\">What's next for Windows release notes</a>.</li>\n<li>A list of the latest servicing stack updates for each operating system can be found in <a href=\"https://msrc.microsoft.com/update-guide/en-us/vulnerability/ADV990001\">ADV990001</a>. This list will be updated whenever a new servicing stack update is released. It is important to install the latest servicing stack update.</li>\n<li>In addition to security changes for the vulnerabilities, updates include defense-in-depth updates to help improve security-related features.</li>\n<li>Customers running Windows 7, Windows Server 2008 R2, or Windows Server 2008 need to purchase the Extended Security Update to continue receiving security updates. See <a href=\"https://support.microsoft.com/en-us/topic/procedure-to-continue-receiving-security-updates-after-extended-support-ends-on-january-14-2020-48c59204-fe67-3f42-84fc-c3c3145ff28e\">4522133</a> for more information.</li>\n</ul>\n<h2>FAQs, Mitigations, and Workarounds</h2>\n<p>The following CVEs have FAQs, Mitigations, or Workarounds. You can see these in more detail from the Vulnerabilities tab by selecting <strong>FAQs</strong>, <strong>Mitigations</strong> and <strong>Workarounds</strong> columns in the <strong>Edit Columns</strong> panel.</p>\n<ul>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-26414\">CVE-2021-26414</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31199\">CVE-2021-31199</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31201\">CVE-2021-31201</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31938\">CVE-2021-31938</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31939\">CVE-2021-31939</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31940\">CVE-2021-31940</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31941\">CVE-2021-31941</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31942\">CVE-2021-31942</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31943\">CVE-2021-31943</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31944\">CVE-2021-31944</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31945\">CVE-2021-31945</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31946\">CVE-2021-31946</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31949\">CVE-2021-31949</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31955\">CVE-2021-31955</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31956\">CVE-2021-31956</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31958\">CVE-2021-31958</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31959\">CVE-2021-31959</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31960\">CVE-2021-31960</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31962\">CVE-2021-31962</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31965\">CVE-2021-31965</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31967\">CVE-2021-31967</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31971\">CVE-2021-31971</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31972\">CVE-2021-31972</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31975\">CVE-2021-31975</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31976\">CVE-2021-31976</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31977\">CVE-2021-31977</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31978\">CVE-2021-31978</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31980\">CVE-2021-31980</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31983\">CVE-2021-31983</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31985\">CVE-2021-31985</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-33739\">CVE-2021-33739</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-33741\">CVE-2021-33741</a></li>\n<li><a href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-33742\">CVE-2021-33742</a></li>\n</ul>\n<h2>Known Issues</h2>\n<p>You can see these in more detail from the Deployments tab by selecting <strong>Known Issues</strong> column in the <strong>Edit Columns</strong> panel.</p>\n<p>For more information about Windows Known Issues, please see <a href=\"https://docs.microsoft.com/en-us/windows/release-information/windows-message-center\">Windows message center</a> (links to currently-supported versions of Windows are in the left pane).</p>\n<table>\n<thead>\n<tr>\n<th>KB Article</th>\n<th>Applies To</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5001944\">5001944</a></td>\n<td>SharePoint Server 2019</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5001946\">5001946</a></td>\n<td>SharePoint Enterprise Server 2016</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5001962\">5001962</a></td>\n<td>SharePoint Foundation 2013</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003635\">5003635</a></td>\n<td>Windows 10, Version 1909</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003637\">5003637</a></td>\n<td>Windows 10, version 21H1, Windows 10, Version 2004, Windows Server, Version 2004, Windows 10, Version 20H2, Windows Server, Version 20H2</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003646\">5003646</a></td>\n<td>Windows 10, Version 1809, Windows Server 2019</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003661\">5003661</a></td>\n<td>Windows Server 2008 Service Pack 2 ((Monthly Rollup)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003667\">5003667</a></td>\n<td>Windows 7 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Monthly Rollup)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003671\">5003671</a></td>\n<td>Windows 8.1, Windows Server 2012 R2 (Monthly Rollup)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003681\">5003681</a></td>\n<td>Windows 8.1, Windows Server 2012 R2 (Security-only update)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003694\">5003694</a></td>\n<td>Windows 7 Service Pack 1, Windows Server 2008 R2 Service Pack 1 (Security-only update)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003695\">5003695</a></td>\n<td>Windows Server 2008 Service Pack 2 (Security-only update)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003696\">5003696</a></td>\n<td>Windows Server 2012 (Security-only update)</td>\n</tr>\n<tr>\n<td><a href=\"https://support.microsoft.com/help/5003697\">5003697</a></td>\n<td>Windows Server 2012 (Monthly Rollup)</td>\n</tr>\n</tbody>\n</table>\n",
				"title": "Release Notes",
				"audience": "Public",
				"type": "Details",
				"ordinal": "0"
			},
			{
				"text": "The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.",
				"title": "Legal Disclaimer",
				"audience": "Public",
				"type": "Legal Disclaimer",
				"ordinal": "1"
			}
		]
	},
	"producttree": {
		"branch": {
			"type": "Vendor",
			"name": "Microsoft",
			"branch": [
				{
					"type": "Product Family",
					"name": "System Center",
					"fullproductname": [
						{
							"text": "Microsoft Malware Protection Engine",
							"productid": "11902"
						}
					]
				}
			]
		}
	},
	"vulnerability": [
		{
			"ordinal": "95",
			"title": "Microsoft Defender Remote Code Execution Vulnerability",
			"notes": {
				"note": [
					{
						"title": "Description",
						"type": "Description",
						"ordinal": "0"
					},
					{
						"text": "<table>\n<thead>\n<tr>\n<th>References</th>\n<th>Identification</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>First version of the Microsoft Malware Protection Engine with this vulnerability addressed</td>\n<td>Version  1.1.18200.3</td>\n</tr>\n</tbody>\n</table>\n<p>See <a href=\"https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/manage-updates-baselines-microsoft-defender-antivirus\">Manage Updates Baselines Microsoft Defender Antivirus</a> for more information.</p>\n<p><strong>Microsoft Defender is disabled in my environment, why are vulnerability scanners showing that I am vulnerable to this issue?</strong></p>\n<p>Vulnerability scanners are looking for specific binaries and version numbers on devices. Microsoft Defender files are still on disk even when disabled. Systems that have disabled Microsoft Defender are not in an exploitable state.</p>\n<p><strong>Why is no action required to install this update?</strong></p>\n<p>In response to a constantly changing threat landscape, Microsoft frequently updates malware definitions and the Microsoft Malware Protection Engine. In order to be effective in helping protect against new and prevalent threats, antimalware software must be kept up to date with these updates in a timely manner.</p>\n<p>For enterprise deployments as well as end users, the default configuration in Microsoft antimalware software helps ensure that malware definitions and the Microsoft Malware Protection Engine are kept up to date automatically. Product documentation also recommends that products are configured for automatic updating.</p>\n<p>Best practices recommend that customers regularly verify whether software distribution, such as the automatic deployment of Microsoft Malware Protection Engine updates and malware definitions, is working as expected in their environment.</p>\n<p><strong>How often are the Microsoft Malware Protection Engine and malware definitions updated?</strong></p>\n<p>Microsoft typically releases an update for the Microsoft Malware Protection Engine once a month or as needed to protect against new threats. Microsoft also typically updates the malware definitions three times daily and can increase the frequency when needed.</p>\n<p>Depending on which Microsoft antimalware software is used and how it is configured, the software may search for engine and definition updates every day when connected to the Internet, up to multiple times daily. Customers can also choose to manually check for updates at any time.</p>\n<p><strong>What is the Microsoft Malware Protection Engine?</strong></p>\n<p>The Microsoft Malware Protection Engine, mpengine.dll, provides the scanning, detection, and cleaning capabilities for Microsoft antivirus and antispyware software.</p>\n<p><strong>Windows Defender uses the Microsoft Malware Protection Engine. On which products is Defender installed and active by default?</strong></p>\n<p>Defender runs on all supported version of Windows.</p>\n<p><strong>Are there other products that use the Microsoft Malware Protection Engine?</strong></p>\n<p>Yes, Microsoft System Center Endpoint Protection, Microsoft System Center 2012 R2 Endpoint Protection, Microsoft System Center 2012 Endpoint Protection and Microsoft Security Essentials.</p>\n<p><strong>Does this update contain any additional security-related changes to functionality?</strong></p>\n<p>Yes.  In addition to the changes that are listed for this vulnerability, this update includes defense-in-depth updates to help improve security-related features.</p>\n<h2>Suggested Actions</h2>\n<p><strong>Verify that the update is installed</strong></p>\n<p>Customers should verify that the latest version of the Microsoft Malware Protection Engine and definition updates are being actively downloaded and installed for their Microsoft antimalware products.</p>\n<ol>\n<li>Open the Windows Security program. For example, type Security in the Search bar, and select the Windows Security program.</li>\n<li>In the navigation pane, select Virus &amp; threat protection.</li>\n<li>Under Virus &amp; threat protection updates in the main window, select Check for updates</li>\n<li>Select Check for updates again.</li>\n<li>In the navigation pane, select Settings, and then select About.</li>\n<li>Examine the Engine Version number. The update was successfully installed if the Malware Protection Engine version number or the signature package version number matches or exceeds the version number that you are trying to verify as installed.</li>\n</ol>\n<p>For affected software, verify that the Microsoft Malware Protection Engine version is 1.1.18200.3 or later.</p>\n<p><strong>If necessary, install the update</strong></p>\n<p>Administrators of enterprise antimalware deployments should ensure that their update management software is configured to automatically approve and distribute engine updates and new malware definitions. Enterprise administrators should also verify that the latest version of the Microsoft Malware Protection Engine and definition updates are being actively downloaded, approved and deployed in their environment.</p>\n<p>For end-users, the affected software provides built-in mechanisms for the automatic detection and deployment of this update. For these customers, the update will be applied within 48 hours of its availability. The exact time frame depends on the software used, Internet connection, and infrastructure configuration.</p>\n<p>End users that do not wish to wait can manually update their antimalware software.</p>\n",
						"title": "FAQ",
						"type": "FAQ",
						"ordinal": "10"
					},
					{
						"text": "Windows Defender",
						"title": "Windows Defender",
						"type": "Tag",
						"ordinal": "20"
					},
					{
						"text": "Microsoft",
						"title": "Microsoft",
						"type": "CNA",
						"ordinal": "30"
					}
				]
			},
			"cve": "CVE-2021-31985",
			"productstatuses": {
				"status": {
					"type": "Known Affected",
					"product_id": [
						"11902"
					]
				}
			},
			"threats": {
				"threat": [
					{
						"type": "Impact",
						"description": "Remote Code Execution",
						"product_id": "11902"
					},
					{
						"type": "Severity",
						"description": "Critical",
						"product_id": "11902"
					},
					{
						"type": "Exploit Status",
						"description": "Publicly Disclosed:No;Exploited:No;Latest Software Release:Exploitation More Likely;Older Software Release:Exploitation More Likely;DOS:N/A"
					}
				]
			},
			"cvssscoresets": {
				"scoreset": [
					{
						"base_score": "7.8",
						"temporal_score": "6.8",
						"vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C",
						"product_id": "11902"
					}
				]
			},
			"remediations": {
				"remediation": [
					{
						"type": "Vendor Fix",
						"description": "Release Notes",
						"product_id": [
							"11902"
						],
						"affectedfiles": {},
						"restart_required": "No",
						"sub_type": "Security Update",
						"fixed_build": "Version 1.1.18200.3"
					}
				]
			},
			"acknowledgments": {
				"acknowledgment": [
					{
						"name": "Tavis Ormandy, Google Project Zero"
					}
				]
			},
			"revisionhistory": {
				"revision": [
					{
						"number": "1.0",
						"date": "2021-06-08T07:00:00",
						"description": "<p>Information published.</p>\n"
					}
				]
			}
		}
	]
}
